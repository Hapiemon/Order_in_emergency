<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>æ³¨æ–‡å—ä»˜çµ‚äº† - å¸­{{ seat }}</title>
    <link rel="stylesheet" href="/static/style.css">
</head>
<body>
    <div class="notice-container">
        <div class="notice-content">
            <h1>ğŸ“ æ³¨æ–‡å—ä»˜çµ‚äº†ã®ãŠçŸ¥ã‚‰ã›</h1>
            <div class="seat-info">
                <h2>å¸­ {{ seat }}</h2>
            </div>
            <div class="message">
                <p class="main-message">æ³¨æ–‡å—ä»˜æ™‚é–“ã¯çµ‚äº†ã—ã¦ã„ã¾ã™ã€‚</p>
                <p class="sub-message">ãŠé£Ÿäº‹ã‚’ãŠæ¥½ã—ã¿ãã ã•ã„ã€‚</p>
                <p class="sub-message">ãŠä¼šè¨ˆã®æº–å‚™ã‚’ãŠé¡˜ã„ã„ãŸã—ã¾ã™ã€‚</p>
            </div>
            <div class="actions">
                <a href="{{ url_for('index') }}" class="button primary">ãƒˆãƒƒãƒ—ãƒšãƒ¼ã‚¸ã«æˆ»ã‚‹</a>
            </div>
            <div class="remaining-time" id="remaining-time">
                <!-- JavaScript ã§æ®‹ã‚Šæ™‚é–“ã‚’è¡¨ç¤º -->
            </div>
        </div>
    </div>

    <script>
        // å¸­ã®æ®‹ã‚Šæ™‚é–“ã‚’è¡¨ç¤º
        document.addEventListener('DOMContentLoaded', async () => {
            const seatNum = {{ seat }};
            
            async function updateTimer() {
                try {
                    const response = await fetch('/timer_update');
                    const timerData = await response.json();
                    
                    if (timerData && timerData[seatNum]) {
                        const info = timerData[seatNum];
                        const remainingElement = document.getElementById('remaining-time');
                        
                        if (info.seat_remaining_minutes > 0 || info.seat_remaining_seconds > 0) {
                            remainingElement.innerHTML = `
                                <p class="timer-info">å¸­ã®æ®‹ã‚Šæ™‚é–“: ${info.seat_remaining_minutes}åˆ† ${info.seat_remaining_seconds}ç§’</p>
                            `;
                        } else {
                            remainingElement.innerHTML = `
                                <p class="timer-expired">å¸­ã®ãŠæ™‚é–“ãŒçµ‚äº†ã—ã¾ã—ãŸã€‚ãŠä¼šè¨ˆã‚’ãŠé¡˜ã„ã—ã¾ã™ã€‚</p>
                            `;
                            // ä¼šè¨ˆæ¡ˆå†…ãƒšãƒ¼ã‚¸ã«ãƒªãƒ€ã‚¤ãƒ¬ã‚¯ãƒˆ
                            setTimeout(() => {
                                window.location.href = '/seat/' + seatNum;
                            }, 3000);
                        }
                    }
                } catch (error) {
                    console.error('Timer update error:', error);
                }
            }
            
            // åˆå›æ›´æ–°
            updateTimer();
            // 5ç§’ã”ã¨ã«æ›´æ–°
            setInterval(updateTimer, 5000);
        });
    </script>
</body>
</html>
